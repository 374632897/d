function showEle(a){a.style.display=""}function hideEle(a){a.style.display="none"}function employeeImage(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,r,d=window.location.href.toLowerCase(),e=d.indexOf("/detail.aspx")>-1;return hasFnEnter=!1,divContent=divContenthandler(a),f=window.navigator.userAgent.toLowerCase(),c&&window.divContent&&(g=divContent.clientHeight,g>4500||window.savewx)?-1==f.indexOf("wxwork")&&f.toLowerCase().indexOf("micromessenger")>-1?(window.location.href=c,void 0):(h=document.getElementById("saveWxCeshiReport"),i=h.getElementsByTagName("img")[0],i.src=i.getAttribute("xsrc"),PDF_launch("saveWxCeshiReport",400,380),void 0):(joinId=b||window.joinId||"",j=a,j.style.visibility="hidden",k=document.getElementById("divSetDisplay"),l=document.getElementById("hrefSetReport"),k&&hideEle(k),l&&hideEle(l),window.isMobile&&$(".ranking__btn").hide(),isCache?($("#showImgBox").show().prev().hide(),j.style.visibility="visible",!1):(m=divContent.clientWidth,n=divContent.clientHeight,o=document.createElement("canvas"),o.width=2*m,o.height=2*n,o.style.width=m+"px",o.style.height=n+"px",p=o.getContext("2d"),p.scale(2,2),q=function(a){var b=function(a){var b=[];return Array.prototype.forEach.call(a,function(a){(a.src.indexOf("pubnew.paperol.cn")>-1||a.src.indexOf("pubnewfr.paperol.cn")>-1||a.src.indexOf("pubali.paperol.cn")>-1||a.src.indexOf("pubalifr.paperol.cn")>-1)&&b.push(a)}),b},c=function(b){var f=b.src,g=f.replace("pubnew.paperol.cn",e).replace("pubnewfr.paperol.cn",e).replace("pubali.sojump.cn",e).replace("pubalifr.sojump.cn",e);b.src=g,b.onload=function(){d++,a[d]?c(a[d]):r()}},d=0,e="pubref.paperol.cn";a=b(a),a.length>0?c(a[d]):r()},r=function(){n>4900&&(n=4900),setTimeout(function(){html2canvas(divContent,{canvas:o,height:n,useCORS:!0,logging:!0}).then(function(a){var b,c,d,f,h,i,m,n,o;if(j.style.visibility="visible",k&&showEle(k),l&&showEle(l),b=new Image,c=a.toDataURL("image/png"),b.src=c,window.isMobile)m="margin-bottom:10px;margin-top: 44px;",e&&(m=""),n=$("#showImgBox"),n[0]||(n=$(divContent).find(".reportimgwrap"),n[0]||(n=$("<div class='reportimgwrap'></div>").insertAfter(divContent))),o='<a href="javascript:" style="text-align:center;color:#FF6A00;width:40px;height: 24px;line-height: 24px;display:inline-block;background-color:#FFF3EB;border:1px solid #FFC399;font-size:12px;float:right;margin-top: 10px;border-radius: 2px">返回</a>',n.html('<div style="'+m+'" class="reportimg"></div><div style="padding:0 20px;color:#FF6A00;background:#FFF3EB;font-size:14px;position: fixed;top:0;left:0;right:0;height:44px;line-height:44px;">已生成图片，长按下图保存图片'+o+"</div>"),n.find(".reportimg").html(b),n.show().prev().hide(),n.find("a").click(function(){isIosSystem()&&window.getAwardType&&4==window.getAwardType&&window.location.reload(!0),$(".ranking__btn").show(),$(".not_wrap").show(),n.hide().prev().show()}),isCache=!0,setTimeout(function(){window.scroll(0,0)},300);else if(browserIsIe())try{d=a.msToBlob(),f=new Blob([d]),window.navigator.msSaveBlob(f,activityId+"_"+joinId+".png")}catch(g){alert("提示：您的浏览器版本过低，请直接截图保存！")}else h=document.createElement("a"),h.download=activityId+"_"+joinId,i=new MouseEvent("click"),h.href=b.src,h.dispatchEvent(i)})},0)},q(divContent.getElementsByTagName("img")),void 0))}function browserIsIe(){var a=window.navigator.userAgent.toLowerCase();return a.indexOf("edge")>-1?!0:window.ActiveXObject||"ActiveXObject"in window?!0:!1}function isIosSystem(){var c,a=navigator.userAgent;return navigator.appVersion,c=!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),c?!0:void 0}function loadCanvasJs(){var c,e,a=0,b=navigator.userAgent;-1==b.indexOf("wxwork")&&b.toLowerCase().indexOf("micromessenger")>-1&&(a=1),c=window.location.href.toLowerCase(),c.indexOf("/complete")>-1,e=document.createElement("script"),e.type="text/javascript",e.src="//image.wjx.com/wxloj/html2canvas.js",document.getElementsByTagName("head")[0].appendChild(e),(window.ActiveXObject||"ActiveXObject"in window)&&(e=document.createElement("script"),e.type="text/javascript",e.src="https://cdn.staticfile.org/bluebird/3.7.2/bluebird.min.js",document.getElementsByTagName("head")[0].appendChild(e))}function divContenthandler(a){var e,b=window.location.href.toLowerCase(),c=b.indexOf("/user/")>-1||b.indexOf("resultquery.aspx")>-1,d=b.indexOf("/detail.aspx")>-1;return c||d?(divContent=$(a).parent().parent()[0],"divDownLoad"==a.parentNode.id&&(divContent=divContent.parentNode),"divattrsign"==divContent.id&&(divContent=divContent.parentNode.parentNode),hasFnEnter||$(".not_wrap").hide()):window.isMobile&&(e=document.getElementById("divCepingResult"),window.divdsc&&""==divdsc.style.display&&(divContent=divdsc),e&&""==e.style.display&&(divContent=e)),sloveHtml2CanvasStyleLose(divContent),divContent}function divContentFn(){hasFnEnter=!0,divContent=divContenthandler(document.getElementById("hrefSavecatReport")),sloveHtml2CanvasStyleLose(divContent),divContent.clientHeight>4900&&(document.getElementById("hrefSavecatReport").style.display="none")}function sloveHtml2CanvasStyleLose(a){Array.from(a.querySelectorAll(".icon.comIcon")).forEach(function(a){var b=a.style.cssText;a.style.cssText=b+="font-family: comIcon !important;"})}var isCache=!1,hasFnEnter=!1;setTimeout(function(){var a,b,c;loadCanvasJs(),a=window.location.href.toLowerCase(),b=a.indexOf("/user/")>-1||a.indexOf("resultquery.aspx")>-1,b&&(c=document.getElementById("divattrsign"),c?divContentFn():$(divContent).find(".query__data").on("click",function(){setTimeout(function(){divContentFn()},300)}))},100);